apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-app
  labels:
		environment: dev
		app: nginx-app
  
spec:
  replicas: 2
  backoffLimit: 4
  selector:
		matchLabels:
			app: nginx-app
  template:
    metadata:
			labels:
				app: nginx-app
    spec:
      restartPolicy: Never
      volumes:
    	- name: mysql-persistent-storage
    		emptyDir: {}
    	- name: mysql-storage
    		hostPath:
    			path: /data
    			type: Directory
    	- name: mysql-persistent-storage
        persistentVolumeClaim:
          claimName: mysql-pv-claim
    	- name: config-volume-one
    		configMap:
    			name: trading-strategy
    	- name: config-volume-three
    		configMap:
    			name: trading-anand
    	- name: config-volume-two
    		configMap:
    			name: config-two
    				items:
            - key: strategy.risk
              path: risk
            - key: strategy.anand
              path: anand
      containers:
    	- name: nginx
    		image: nginx:1.7.9
      	ports:
      	- name: port80
      		containerPort: 80
      		
      	- name: port8080
      		containerPort: 8080
      		
      	resources:
      		limits:
      			cpu: "1000m"
      			memory: "2Gi"
      		requests:
      			cpu: "1000m"
      			memory: "2Gi"
    		volumeMounts:
      	- name: all-in-one
      		mountPath: /projected-volume
      		readOnly: true

      	- name: all-in-two
      		mountPath: /projected-volume
      		readOnly: true

    	- name: nginx1
    		image: nginx:1.7.9
      	ports:
      	- name: nginxPort
      		containerPort: 80
      		protocol: TCP
      	- name: nginxPort1
      		containerPort: 8080
      		protocol: TCP
      	resources:
      		limits:
      			cpu: "1000m"
      			memory: "2Gi"
      		requests:
      			cpu: "1000m"
      			memory: "2Gi"
